---
title: 'Redux Persist 상태 마이그레이션 다루기'
date: '2023-03-09'
lastmod: '2025-08-17'
# tags: ['react-native', 'async-storage', 'redux-persist', 'redux-toolkit']
draft: true
summary: 'Redux-toolkit, redux-persist, AsyncStorage를 함께 사용하여 React Native 앱의 상태를 영구적으로 저장하는 방법을 다룹니다. 스토어 설정부터 적용까지 전체 과정을 예제 코드를 통해 확인해 보세요.'
images: ['redux-persist-configuration-thumbnail']
authors: ['authorgg']
---

이 글은 시리즈 1에서 다룬 **Redux Persist + AsyncStorage + Redux Toolkit 구성**에 이어지는 내용으로,  
**리덕스 상태(state) 구조가 변경되었을 때 기존의 persisted 데이터를 안전하게 마이그레이션하는 방법**을 다룹니다.

---

### 1. 왜 마이그레이션이 필요할까요?

예를 들어 `settingsSlice` 안에 `currency`라는 속성을 새로 추가했다고 해봅시다.  
이때 기존 사용자의 persisted 상태에는 해당 속성이 없기 때문에, 앱에서 이 값을 읽으려 하면 `undefined`가 반환될 수 있습니다.

이러한 문제를 해결하기 위해서는 앱 버전이 업데이트될 때, persisted state에 누락된 초기값을 채워 넣어 주는 **마이그레이션 과정**이 필요합니다.  
데이터베이스에서 스키마를 업데이트하는 과정과 비슷한 개념입니다.

---

통화 설정 값을

```diff-ts:src/store/slices/Settings.ts
import { createSlice, PayloadAction } from '@reduxjs/toolkit';

interface SettingsState {
  darkMode: boolean;
  language: 'en' | 'ko';
+ currency: 'krw' | 'usd' | 'eur';
}

const initialState: SettingsState = {
  darkMode: false,
  language: 'ko',
+ currency: 'krw'
};

const settingsSlice = createSlice({
  name: 'settings',
  initialState,
  reducers: {
    toggleDarkMode(state) {
      state.darkMode = !state.darkMode;
    },
    setLanguage(state, action: PayloadAction<'en' | 'ko'>) {
      state.language = action.payload;
    },
+   setCurrency(state, action: PayloadAction<'krw' | 'usd' | 'eur'>) {
+     state.currency = action.payload;
+   }
  },
});

export const {
  toggleDarkMode,
  setLanguage,
+ setCurrency
} = settingsSlice.actions;
export default settingsSlice.reducer;
```
